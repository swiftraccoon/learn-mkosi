# Level 0: Development/Learning
# Target: Local development, learning mkosi, experimentation
# Security: Basic protections, prioritizes convenience over security
# WARNING: NOT suitable for production use

[Config]
MinimumVersion=25

[Distribution]
Distribution=fedora
Release=42

[Output]
Format=disk
OutputDirectory=mkosi.output
ImageId=fedora-dev-level0
ImageVersion=1.0
CompressOutput=zstd

[Content]
# Minimal package set for functional system
Packages=
    # Kernel & Core System
    kernel
    systemd
    systemd-udev
    dbus
    dbus-broker

    # Base Utilities
    coreutils
    util-linux
    bash
    grep
    sed
    gawk
    findutils
    which
    procps-ng
    psmisc
    shadow-utils
    sudo
    less
    tar
    gzip
    bzip2
    xz

    # Filesystem
    filesystem
    e2fsprogs
    dosfstools

    # Networking
    NetworkManager
    iproute
    iputils
    hostname

    # Security Baseline (minimal for development)
    selinux-policy-targeted
    policycoreutils
    firewalld
    cracklib-dicts
    cryptsetup

    # CPU Microcode Updates (security-critical firmware)
    microcode_ctl

    # Kernel Modules (for network filesystems & crypto)
    kernel-modules-extra

    # Package Management
    dnf
    rpm

    # Text Editor
    vim-minimal

    # Time & SSL
    tzdata
    ca-certificates
    chrony

    # Bootloader
    systemd-boot-unsigned

# Build-time only packages
BuildPackages=
    systemd-rpm-macros

# Minimize image size
WithDocs=no
WithRecommends=no
CleanPackageMetadata=auto

# SELinux configuration
SELinuxRelabel=yes

# First boot configuration (systemd-firstboot)
# These settings prevent interactive prompts on first boot
Locale=C.UTF-8
LocaleMessages=C.UTF-8
Timezone=UTC
Hostname=fedora-level0-dev

# Root Password: Development Convenience
# Level 0 is for LOCAL DEVELOPMENT ONLY - prioritizes convenience
#
# Passwordless root for easy access during development:
RootPassword=hashed:
#
# This creates an unlocked root account with NO password required.
# You can log in by just pressing Enter at the login prompt.
#
# WARNING: NEVER use this in production or network-accessible systems!
#
# For slightly better security during development, set a simple password:
#   RootPassword=dev
#
# For production use, see Level 1 configuration.

# Bootloader configuration
Bootable=yes
Bootloader=systemd-boot
UnifiedKernelImages=unsigned

# Kernel command line embedded in UKI
KernelCommandLine=rw console=hvc0

# Post-installation script
PostInstallationScripts=mkosi.postinst

[Runtime]
# Runtime configuration for testing with QEMU
Firmware=uefi
RAM=2G
CPUs=2
# Use hvc0 for virtio console (not ttyS0 for legacy serial)
KernelCommandLineExtra=console=hvc0
